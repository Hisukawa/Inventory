import{r as o,j as e,S}from"./app-DQkT4LlC.js";import{Q as v}from"./index-CCX4IZCu.js";import{A as w}from"./app-sidebar-BujqyJlq.js";import{S as E,a as C,b as R,c as y,B as L,d as _,e as B,f as k}from"./nav-user-_AATWMKL.js";import"./index-Bzr5cZvq.js";import"./index-CLrO4Jv1.js";function F(){const[r,d]=o.useState(""),[l,c]=o.useState(""),[u,h]=o.useState([]),[j,p]=o.useState([]),[n,f]=o.useState(null),[x,m]=o.useState("");o.useEffect(()=>{fetch("/api/rooms").then(t=>t.json()).then(t=>{console.log("Loaded rooms:",t),h(t),p(t)})},[]);const g=t=>{const a=t.target.value;c(a),p(u.filter(i=>i.room_number.toLowerCase().includes(a.toLowerCase())))},q=t=>{t.preventDefault();const a=u.find(s=>s.room_number.toLowerCase()===l.toLowerCase());if(!a){m("Please select a valid room.");return}const i=r.trim().toLowerCase(),b=`${a.qr_code}/${i}`;S.post("/admin/equipment",{room_id:a.id,equipment_name:r,qr_code:b},{onSuccess:()=>{f(b),m("Equipment added successfully!"),d(""),c("")},onError:s=>{const N=typeof s=="string"?s:(s==null?void 0:s.equipment_name)||"Error adding equipment.";m(N)}})};return e.jsxs(E,{children:[e.jsx(w,{}),e.jsxs(C,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(R,{}),e.jsx(y,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(L,{children:e.jsx(_,{children:e.jsx(B,{children:e.jsx(k,{href:"/admin/equipment/create",children:"Equipment Management"})})})})]}),e.jsx("main",{className:"p-6",children:e.jsxs("div",{className:"max-w-xl mx-auto p-6 bg-white rounded shadow",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Add Equipment"})}),x&&e.jsx("div",{className:"bg-green-100 p-2 mb-4 rounded",children:x}),e.jsxs("form",{onSubmit:q,children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Room Number"}),e.jsx("input",{type:"text",value:l,onChange:g,list:"room-list",placeholder:"Type room number (e.g. 103)",className:"border p-2 w-full mb-4 rounded",required:!0}),e.jsx("datalist",{id:"room-list",children:j.map(t=>e.jsx("option",{value:t.room_number},t.id))}),e.jsx("label",{className:"block mb-1 font-medium",children:"Equipment Name"}),e.jsx("input",{type:"text",value:r,onChange:t=>d(t.target.value),placeholder:"e.g. PC-01",className:"border p-2 w-full mb-4 rounded",required:!0}),e.jsx("div",{className:"text-end",children:e.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition",children:"Add Equipment"})})]}),n&&e.jsxs("div",{className:"mt-8 text-center",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"QR Code for Equipment"}),e.jsx("div",{className:"inline-block bg-white p-4 border rounded shadow",children:e.jsx(v,{value:n,size:180})}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:n})]})]})})]})]})}export{F as default};
